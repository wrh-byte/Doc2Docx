import os
import re
import shutil

import docx


def document_classify():
    country_dic = {
        '阿富汗': 1,
        '奥兰群岛': 1,
        '阿尔巴尼亚': 1,
        '阿尔及利亚': 1,
        '美属萨摩亚': 1,
        '安道尔': 1,
        '安哥拉': 1,
        '安圭拉': 1,
        '安提瓜和巴布达': 1,
        '阿根廷': 1,
        '亚美尼亚': 1,
        '阿鲁巴': 1,
        '澳大利亚': 1,
        '奥地利': 1,
        '阿塞拜疆': 1,
        '孟加拉': 1,
        '巴林': 1,
        '巴哈马': 1,
        '巴巴多斯': 1,
        '白俄罗斯': 1,
        '比利时': 1,
        '伯利兹': 1,
        '贝宁': 1,
        '百慕大': 1,
        '不丹': 1,
        '玻利维亚': 1,
        '波斯尼亚和黑塞哥维那': 1,
        '博茨瓦纳': 1,
        '布维岛': 1,
        '巴西': 1,
        '文莱': 1,
        '保加利亚': 1,
        '布基纳法索': 1,
        '布隆迪': 1,
        '柬埔寨': 1,
        '喀麦隆': 1,
        '加拿大': 1,
        '佛得角': 1,
        '中非': 1,
        '乍得': 1,
        '智利': 1,
        '圣诞岛': 1,
        '科科斯（基林）群岛': 1,
        '哥伦比亚': 1,
        '科摩罗': 1,
        '刚果（金）': 1,
        '刚果': 1,
        '库克群岛': 1,
        '哥斯达黎加': 1,
        '科特迪瓦': 1,
        '中国': 1,
        '克罗地亚': 1,
        '古巴': 1,
        '捷克': 1,
        '塞浦路斯': 1,
        '丹麦': 1,
        '吉布提': 1,
        '多米尼加': 1,
        '厄瓜多尔': 1,
        '埃及': 1,
        '赤道几内亚': 1,
        '厄立特里亚': 1,
        '爱沙尼亚': 1,
        '埃塞俄比亚': 1,
        '法罗群岛': 1,
        '斐济': 1,
        '芬兰': 1,
        '法国': 1,
        '法国大都会': 1,
        '法属圭亚那': 1,
        '法属波利尼西亚': 1,
        '加蓬': 1,
        '冈比亚': 1,
        '格鲁吉亚': 1,
        '德国': 1,
        '加纳': 1,
        '直布罗陀': 1,
        '希腊': 1,
        '格林纳达': 1,
        '瓜德罗普岛': 1,
        '关岛': 1,
        '危地马拉': 1,
        '根西岛': 1,
        '几内亚比绍': 1,
        '几内亚': 1,
        '圭亚那': 1,
        '海地': 1,
        '洪都拉斯': 1,
        '匈牙利': 1,
        '冰岛': 1,
        '印度': 1,
        '印度尼西亚': 1,
        '伊朗': 1,
        '伊拉克': 1,
        '爱尔兰': 1,
        '马恩岛': 1,
        '以色列': 1,
        '意大利': 1,
        '牙买加': 1,
        '日本': 1,
        '泽西岛': 1,
        '约旦': 1,
        '哈萨克斯坦': 1,
        '肯尼亚': 1,
        '基里巴斯': 1,
        '韩国': 1,
        '朝鲜': 1,
        '科威特': 1,
        '吉尔吉斯斯坦': 1,
        '老挝': 1,
        '拉脱维亚': 1,
        '黎巴嫩': 1,
        '莱索托': 1,
        '利比里亚': 1,
        '利比亚': 1,
        '列支敦士登': 1,
        '立陶宛': 1,
        '卢森堡': 1,
        '马其顿': 1,
        '马拉维': 1,
        '马来西亚': 1,
        '马达加斯加': 1,
        '马尔代夫': 1,
        '马里': 1,
        '马耳他': 1,
        '马绍尔群岛': 1,
        '马提尼克岛': 1,
        '毛里塔尼亚': 1,
        '毛里求斯': 1,
        '马约特': 1,
        '墨西哥': 1,
        '密克罗尼西亚': 1,
        '摩尔多瓦': 1,
        '摩纳哥': 1,
        '蒙古': 1,
        '黑山': 1,
        '蒙特塞拉特': 1,
        '摩洛哥': 1,
        '莫桑比克': 1,
        '缅甸': 1,
        '纳米比亚': 1,
        '瑙鲁': 1,
        '尼泊尔': 1,
        '荷兰': 1,
        '新喀里多尼亚': 1,
        '新西兰': 1,
        '尼加拉瓜': 1,
        '尼日尔': 1,
        '尼日利亚': 1,
        '纽埃': 1,
        '诺福克岛': 1,
        '挪威': 1,
        '阿曼': 1,
        '巴基斯坦': 1,
        '帕劳': 1,
        '巴勒斯坦': 1,
        '巴拿马': 1,
        '巴布亚新几内亚': 1,
        '秘鲁': 1,
        '菲律宾': 1,
        '皮特凯恩群岛': 1,
        '波兰': 1,
        '葡萄牙': 1,
        '波多黎各': 1,
        '卡塔尔': 1,
        '留尼汪岛': 1,
        '罗马尼亚': 1,
        '卢旺达': 1,
        '俄罗斯联邦': 1,
        '圣赫勒拿': 1,
        '圣基茨和尼维斯': 1,
        '圣卢西亚': 1,
        '圣文森特和格林纳丁斯': 1,
        '萨尔瓦多': 1,
        '萨摩亚': 1,
        '圣马力诺': 1,
        '圣多美和普林西比': 1,
        '沙特阿拉伯': 1,
        '塞内加尔': 1,
        '塞舌尔': 1,
        '塞拉利昂': 1,
        '新加坡': 1,
        '塞尔维亚': 1,
        '斯洛伐克': 1,
        '斯洛文尼亚': 1,
        '所罗门群岛': 1,
        '索马里': 1,
        '南非': 1,
        '西班牙': 1,
        '斯里兰卡': 1,
        '苏丹': 1,
        '苏里南': 1,
        '斯威士兰': 1,
        '瑞典': 1,
        '瑞士': 1,
        '叙利亚': 1,
        '塔吉克斯坦': 1,
        '坦桑尼亚': 1,
        '泰国': 1,
        '特立尼达和多巴哥': 1,
        '东帝汶': 1,
        '多哥': 1,
        '托克劳': 1,
        '汤加': 1,
        '突尼斯': 1,
        '土耳其': 1,
        '土库曼斯坦': 1,
        '图瓦卢': 1,
        '乌干达': 1,
        '乌克兰': 1,
        '阿拉伯联合酋长国': 1,
        '英国': 1,
        '美国': 1,
        '乌拉圭': 1,
        '乌兹别克斯坦': 1,
        '瓦努阿图': 1,
        '梵蒂冈': 1,
        '委内瑞拉': 1,
        '越南': 1,
        '瓦利斯群岛和富图纳群岛': 1,
        '西撒哈拉': 1,
        '也门': 1,
        '南斯拉夫': 1,
        '赞比亚': 1,
        '津巴布韦': 1,
    }
    cv_list = []
    doc_name = []
    for fileName in os.listdir(os.getcwd() + "\\Document\\"):
        path_array = os.path.splitext(os.getcwd() + "\\Document\\" + fileName)
        if path_array[1] == '.docx':
            cv_list.append(os.getcwd() + "\\Document\\" + fileName)
            doc_name.append(fileName)

    result_path = os.getcwd() + "\\Result"
    i = 0
    for path in cv_list:
        # start document
        doc = docx.Document(path)
        match_country_dic = {}
        for paragraph in doc.paragraphs:
            for country in country_dic:
                match = paragraph.text.find(country)
                if match != -1:
                    match_country_dic[country] = 1
        if not bool(match_country_dic):
            match_country_dic['中国'] = 1
        print(i, match_country_dic)
        for dir_name in match_country_dic:
            new_file_path = result_path+"\\"+dir_name
            mkdir(new_file_path)
            shutil.copyfile(path, new_file_path+"\\"+doc_name[i])
        i = i + 1


def mkdir(path):
    path = path.strip()
    path = path.rstrip("\\")
    is_exists = os.path.exists(path)

    # 判断结果
    if not is_exists:
        os.makedirs(path)
        return True
    else:
        return False


if __name__ == '__main__':
    document_classify()
    # test1
